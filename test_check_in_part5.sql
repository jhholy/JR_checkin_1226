-- 测试用例10：团课月卡每日次数限制（单次月卡）
SELECT '测试用例10：团课月卡每日次数限制（单次月卡）' AS test_case;
SELECT handle_check_in(
  '22222222-2222-2222-2222-222222222222',  -- 会员ID
  '测试老会员',                            -- 姓名
  'old@test.com',                         -- 邮箱
  '22222222-3333-4444-5555-666666666666',  -- 团课月卡ID（单次月卡）
  'morning',                              -- 课程类型
  CURRENT_DATE + 1,                       -- 签到日期（明天）
  '09:00-10:30'                           -- 时间段
);

-- 测试用例11：团课月卡超出每日次数限制
SELECT '测试用例11：团课月卡超出每日次数限制' AS test_case;
SELECT handle_check_in(
  '22222222-2222-2222-2222-222222222222',  -- 会员ID
  '测试老会员',                            -- 姓名
  'old@test.com',                         -- 邮箱
  '22222222-3333-4444-5555-666666666666',  -- 团课月卡ID（单次月卡）
  'evening',                              -- 课程类型
  CURRENT_DATE + 1,                       -- 签到日期（明天，与测试用例10同一天）
  '17:00-18:30'                           -- 时间段
);

-- 创建双次月卡用于测试
INSERT INTO membership_cards (
  id, member_id, card_type, card_category, card_subtype,
  valid_until
)
VALUES (
  '66666666-7777-8888-9999-000000000000',
  '22222222-2222-2222-2222-222222222222',
  'group', 'monthly', 'double_monthly',
  CURRENT_DATE + INTERVAL '30 days'
);

-- 测试用例12：双次月卡第一次签到
SELECT '测试用例12：双次月卡第一次签到' AS test_case;
SELECT handle_check_in(
  '22222222-2222-2222-2222-222222222222',  -- 会员ID
  '测试老会员',                            -- 姓名
  'old@test.com',                         -- 邮箱
  '66666666-7777-8888-9999-000000000000',  -- 团课月卡ID（双次月卡）
  'morning',                              -- 课程类型
  CURRENT_DATE + 2,                       -- 签到日期（后天）
  '09:00-10:30'                           -- 时间段
);

-- 测试用例13：双次月卡第二次签到（同一天）
SELECT '测试用例13：双次月卡第二次签到（同一天）' AS test_case;
SELECT handle_check_in(
  '22222222-2222-2222-2222-222222222222',  -- 会员ID
  '测试老会员',                            -- 姓名
  'old@test.com',                         -- 邮箱
  '66666666-7777-8888-9999-000000000000',  -- 团课月卡ID（双次月卡）
  'evening',                              -- 课程类型
  CURRENT_DATE + 2,                       -- 签到日期（后天，与测试用例12同一天）
  '17:00-18:30'                           -- 时间段
);

-- 测试用例14：双次月卡超出每日次数限制
SELECT '测试用例14：双次月卡超出每日次数限制' AS test_case;
SELECT handle_check_in(
  '22222222-2222-2222-2222-222222222222',  -- 会员ID
  '测试老会员',                            -- 姓名
  'old@test.com',                         -- 邮箱
  '66666666-7777-8888-9999-000000000000',  -- 团课月卡ID（双次月卡）
  'morning',                              -- 课程类型
  CURRENT_DATE + 2,                       -- 签到日期（后天，与测试用例12、13同一天）
  '09:00-10:30'                           -- 时间段（与测试用例12相同时段，应该被拒绝）
); 